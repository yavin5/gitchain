<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gitchain</title>
  <meta http-equiv="Content-Security-Policy"
      content="
        default-src 'self';
        script-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://esm.sh 'unsafe-inline' 'wasm-unsafe-eval' 'unsafe-eval';
        connect-src 'self' https://cdn.jsdelivr.net https://api.github.com https://raw.githubusercontent.com https://api-tn10.kaspa.org https://adam.kaspa.green https://alex.kaspa.red https://maxim.kaspa.stream https://sean.kaspa.stream https://eric.kaspa.stream https://troy.kaspa.stream https://noah.kaspa.blue https://paul.kaspa.red https://jack.kaspa.blue https://liam.kaspa.green https://mark.kaspa.green https://jake.kaspa.green https://luke.kaspa.blue https://john.kaspa.red https://mike.kaspa.red https://ryan.kaspa.blue wss://charm-10.kaspa.blue wss://electron-10.kaspa.blue wss://baryon-10.kaspa.green wss://tau-10.kaspa.blue wss://fermion-10.kaspa.green wss://proton-10.kaspa.stream  wss://neutrino-10.kaspa.stream https://faucet-tn10.kaspanet.io;
        style-src 'self' 'unsafe-inline';
        img-src 'self' data:;
      ">
  <link rel="stylesheet" href="styles.css">
  <style>
    .spacer { margin-bottom: 1rem; }
    .hidden { display: none; }
    #message { width: 80%; height: 50px; }
    #chat { border: 1px solid #ccc; height: 200px; overflow-y: auto; margin-top: 1rem; }
    .kaspaSection { border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; }
    .mnemonic { font-family: monospace; background: #f5f5f5; padding: 0.5rem; word-break: break-all; }
    .warning { color: red; font-size: 0.8rem; }
      .blinking {
        animation: blink 1s infinite;
      }
      @keyframes blink {
        50% { opacity: 0; }
      }
      .error {
        color: red;
      }
      .seedColumns {
        display: flex;
        justify-content: space-between;
      }
      .seedColumn {
        width: 48%;
      }
      .seedColumn ol li {
        margin-bottom: 5px;
      }
      .seedColumn input {
        width: 150px;
      }
  </style>
</head>
<body>
  <h1>Gitchain</h1>

  <!-- Existing GitHub PAT Section -->
  <div>
    <input type="text" id="patInput" placeholder="Enter GitHub Personal Access Token">
    <button id="savePat">Save Personal Access Token</button>
  </div>
  <div id="tokenMessage"></div>
  <button id="processTxns" class="hidden">Process Transactions</button>
  <button id="viewChain">View Chain</button>
  <div id="blockHeight" class="spacer"></div>
  <div id="peerId" class="spacer"></div>

  <div class="kaspaSection">
    <h2>Kaspa Communications</h2>

    <details id="walletControls">
      <summary>Wallet Controls</summary>
      <div>
        <p>Status: <span id="walletStatus">No wallet yet: Generate or Activate one</span></p>
        <div id="walletInfo" class="hidden">
          <p><strong>Warning: Save these seed words ONLY on paper, not share!</strong> <span class="warning">Loss means lost funds in your wallet.</span></p>
          <p class="mnemonic" id="mnemonic"></p>
          <p><strong>Address:</strong> <span id="kaspaAddress"></span></p>
          <a href="https://faucet-tn10.kaspanet.io" target="_blank">Get tKAS from Faucet (paste address, claim once)</a><br>
          <button id="connectPeers">Funded? Connect to Peers</button>
        </div>
        <div>
          <p><span>To generate a new wallet:</span></p>
          <p><span>  New password to use: <input type="text" id="kasWalletGenerateSecret"> <button id="generateWallet">Generate New Wallet</button></span></p>
        </div>
        <div>
          <label>Or enter your 24 seed words to restore your existing wallet:</label>
          <div class="seedColumns">
            <div class="seedColumn">
              <ol start="1">
                <li><input type="text" id="word1" placeholder="Word 1"></li>
                <li><input type="text" id="word2" placeholder="Word 2"></li>
                <li><input type="text" id="word3" placeholder="Word 3"></li>
                <li><input type="text" id="word4" placeholder="Word 4"></li>
                <li><input type="text" id="word5" placeholder="Word 5"></li>
                <li><input type="text" id="word6" placeholder="Word 6"></li>
                <li><input type="text" id="word7" placeholder="Word 7"></li>
                <li><input type="text" id="word8" placeholder="Word 8"></li>
                <li><input type="text" id="word9" placeholder="Word 9"></li>
                <li><input type="text" id="word10" placeholder="Word 10"></li>
                <li><input type="text" id="word11" placeholder="Word 11"></li>
                <li><input type="text" id="word12" placeholder="Word 12"></li>
              </ol>
            </div>
            <div class="seedColumn">
              <ol start="13">
                <li><input type="text" id="word13" placeholder="Word 13"></li>
                <li><input type="text" id="word14" placeholder="Word 14"></li>
                <li><input type="text" id="word15" placeholder="Word 15"></li>
                <li><input type="text" id="word16" placeholder="Word 16"></li>
                <li><input type="text" id="word17" placeholder="Word 17"></li>
                <li><input type="text" id="word18" placeholder="Word 18"></li>
                <li><input type="text" id="word19" placeholder="Word 19"></li>
                <li><input type="text" id="word20" placeholder="Word 20"></li>
                <li><input type="text" id="word21" placeholder="Word 21"></li>
                <li><input type="text" id="word22" placeholder="Word 22"></li>
                <li><input type="text" id="word23" placeholder="Word 23"></li>
                <li><input type="text" id="word24" placeholder="Word 24"></li>
              </ol>
            </div>
          </div>
          New password to use: <input type="text" id="kasWalletRestoreSecret"> <button id="restoreWallet">Restore Existing Wallet</button>
        </div>
        <div id="walletAddressRestored" style="display: none;">
          Wallet Address: <span id="addressText"></span><br>
          Balance: <span id="balanceText" style="font-weight: bold; font-family: monospace;"></span>
        </div>
        <div id="faucetMessage" style="display: none;">
          You need to add KAS to your wallet, for free, by requesting it at the faucet page here: <a href="https://faucet-t11.kaspanet.io" target="_blank">Kaspa Testnet 11 Faucet</a>
        </div>
      </div>
    </details>
    <div id="walletInfo" class="hidden">
      <p><strong>Warning: Save these seed words ONLY on paper, not share!</strong> <span class="warning">Loss means lost funds in your wallet.</span></p>
      <p class="mnemonic" id="mnemonic"></p>
      <p><strong>Address:</strong> <span id="kaspaAddress"></span></p>
      <a href="https://faucet-tn10.kaspanet.io" target="_blank">Get tKAS from Faucet (paste address, claim once)</a><br>
      <button id="connectPeers">Funded? Connect to Peers</button>
    </div>
  </div>

  <!-- Chat Section -->
  <div>
    <textarea id="message" placeholder="Type your message..."></textarea>
    <button id="send">Send</button>
  </div>
  <div id="chat"></div>
  <div id="output" class="hidden"></div>

  <script defer="true" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <script type="module">
    import { ec } from 'https://esm.sh/elliptic@6.6.1';
    window.ec = ec;
  </script>
  <script defer="true" src="https://cdn.jsdelivr.net/npm/js-sha3@0.8.0/src/sha3.min.js"></script>

  <!-- Our code â€“ **bundle.js is the Vite output** -->
  <script type="module" src="./js/bundle.js"></script>
  <script type="module" src="./js/main.js"></script>
</body>
</html>
